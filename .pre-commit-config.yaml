repos:
  - repo: https://github.com/psf/black
    rev: 24.4.0
    hooks:
      - id: black
        name: "ðŸ–¤ black"
        language_version: python3
        additional_dependencies: []
        args: [sql]

  - repo: https://github.com/sqlfluff/sqlfluff
    rev: 3.0.7
    hooks:
      - id: sqlfluff-lint
        name: "ðŸ§¹ sqlfluff-lint"
        entry: sqlfluff lint
        language: python
        types: [sql]
      - id: sqlfluff-fix
        name: "ðŸ› ï¸ sqlfluff-fix"
        entry: sqlfluff fix --force
        language: python
        types: [sql]

  - repo: local
    hooks:
      - id: remove-core-file
        name: "ðŸ—‘ï¸ Remove core file if it exists"
        entry: bash -c '[[ -f core && ! -d core ]] && rm core || exit 0'
        language: system
        stages:
          - pre-commit

  - repo: local
    hooks:
      - id: ensure-utf8-encoding
        name: "ðŸŒ Ensure UTF-8 encoding declaration in Python files"
        entry: bash scripts/encoding_check.sh
        language: system
        types: [python]
        stages: [pre-commit]

  - repo: local
    hooks:
      - id: ensure-license-header
        name: "ðŸ“„ Ensure license, copyright, and Kartoza link"
        entry: bash scripts/license_check.sh
        language: system
        types: [python, shell, sql]
        stages: [pre-commit]

  - repo: local
    hooks:
      - id: ensure-google-docstrings
        name: "ðŸ“š Ensure Google-style docstrings in Python modules"
        entry: bash scripts/docstrings_check.sh
        language: system
        types: [python]
        stages: [pre-commit]

  - repo: local
    hooks:
      - id: code-size-feedback
        name: "ðŸ“ Code Size Feedback"
        entry: bash scripts/codebase_size_check.sh
        language: system
        stages: [pre-commit]        

  - repo: local
    hooks:
      - id: test-count-feedback
        name: "ðŸ§ª Test Count Feedback"
        entry: python scripts/commit_test_stats.py
        language: system
        types: [python]
        stages: [pre-commit]

  - repo: https://github.com/PyCQA/isort
    rev: 6.0.1
    hooks:
      - id: isort
        name: "ðŸ“¦ isort - sort Python imports"
        entry: isort --check --diff
        language: python
        types: [python]
        stages: [pre-commit]

  - repo: local
    hooks:
      - id: nixfmt
        name: nixfmt (RFC style)
        description: Format Nix code with nixfmt-rfc-style
        entry: nixfmt
        language: system
        args: ["--"]
        types: [nix]
        exclude: >
          (?x)^(
            nix/sources.nix|
            test_data/.*
          )$

